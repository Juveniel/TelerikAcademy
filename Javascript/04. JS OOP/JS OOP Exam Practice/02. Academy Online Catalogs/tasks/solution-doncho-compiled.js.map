{"version":3,"sources":["solution-doncho.js"],"names":[],"mappings":"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","file":"solution-doncho-compiled.js","sourcesContent":["/* globals module */\nfunction solve() {\n    var item,\n        book,\n        media,\n        catalog,\n        bookCatalog,\n        mediaCatalog,\n        validator,\n        idGeneratorFactory;\n\n    idGeneratorFactory = {\n        get: function () {\n            return (function () {\n                var lastId = 0;\n                return {\n                    getNext: function () {\n                        return lastId += 1;\n                    }\n                };\n            }());\n        }\n    };\n\n    validator = (function () {\n        var CONSTS = {\n            ID: {\n                MIN: 0.00000,\n                MAX: Infinity\n            },\n            NAME: {\n                MIN: 2,\n                MAX: 40\n            },\n            DESCRIPTION: {\n                MIN: 1,\n                MAX: Infinity\n            },\n            GENRE: {\n                MIN: 2,\n                MAX: 20\n            },\n            RATING: {\n                MIN: 1,\n                MAX: 5\n            },\n            DURATION: {\n                MIN: 0.00001,\n                MAX: Infinity\n            },\n            PATTERN: {\n                MIN: 1,\n                MAX: Infinity\n            },\n            COUNT: {\n                MIN: 1,\n                MAX: Infinity\n            }\n        };\n\n        function validateString(str, min, max) {\n            if (typeof (str) !== 'string' ||\n                str.length < min ||\n                str.length > max) {\n                throw new Error('The string must have between ' + min + ' and ' + max + ' characters');\n            }\n        }\n\n        function validateNumber(n, min, max) {\n            if (typeof (n) !== 'number' ||\n                n < min ||\n                n > max) {\n                throw new Error('The number must be between ' + min + ' and ' + max);\n            }\n        }\n\n        function isNotChar(ch) {\n            return isNaN(+ch);\n        }\n\n        return {\n            validateId: function (id) {\n                validateNumber(id, CONSTS.ID.MIN, CONSTS.ID.MAX);\n            },\n            validateName: function (name) {\n                validateString(name, CONSTS.NAME.MIN, CONSTS.NAME.MAX);\n            },\n            validateISBN: function (isbn) {\n                var isString = typeof (isbn) === 'string';\n                var hasCorrectLength = isbn.length === 10 || isbn.length === 13;\n                var hasNotOnlyDigits = isbn.split('').some(isNotChar);\n                if (!isString || !hasCorrectLength || hasNotOnlyDigits) {\n                    throw new Error('The ISBN must contain exactly 10 or 13 digits');\n                }\n            },\n            validateDescription: function (description) {\n                validateString(description, CONSTS.DESCRIPTION.MIN, CONSTS.DESCRIPTION.MAX);\n            },\n            validateRating: function (rating) {\n                validateNumber(rating, CONSTS.RATING.MIN, CONSTS.RATING.MAX);\n            },\n            validateDuration: function (duration) {\n                validateNumber(duration, CONSTS.DURATION.MIN, CONSTS.DURATION.MAX);\n            },\n            validateGenre: function (genre) {\n                validateString(genre, CONSTS.GENRE.MIN, CONSTS.GENRE.MAX);\n            },\n            validatePattern: function (pattern) {\n                validateString(pattern, CONSTS.PATTERN.MIN, CONSTS.PATTERN.MAX);\n            },\n            validateCount: function(count){\n                validateNumber(count, CONSTS.COUNT.MIN, CONSTS.COUNT.MAX);\n            }\n        };\n    }());\n\n    item = (function (parent) {\n        var item,\n            idGenerator;\n        idGenerator = idGeneratorFactory.get();\n        item = Object.create(parent, {\n            name: {\n                get: function () {\n                    return this._name;\n                },\n                set: function (name) {\n                    validator.validateName(name);\n                    this._name = name;\n                }\n            },\n            description: {\n                get: function () {\n                    return this._description;\n                },\n                set: function (description) {\n                    validator.validateDescription(description);\n                    this._description = description;\n                }\n            }\n        });\n\n        item.init = function (name, description) {\n            this.id = idGenerator.getNext();\n            this.name = name;\n            this.description = description;\n            return this;\n        };\n        return item;\n    }({}));\n\n    book = (function (parent) {\n        var book = Object.create(parent, {\n            isbn: {\n                get: function () {\n                    return this._isbn;\n                },\n                set: function (isbn) {\n                    validator.validateISBN(isbn);\n                    this._isbn = isbn;\n                }\n            },\n            genre: {\n                get: function () {\n                    return this._genre;\n                },\n                set: function (genre) {\n                    validator.validateGenre(genre);\n                    this._genre = genre;\n                }\n            }\n        });\n\n        book.init = function (name, isbn, genre, description) {\n            parent.init.call(this, name, description);\n            this.isbn = isbn;\n            this.genre = genre;\n            return this;\n        };\n\n        return book;\n    }(item));\n\n    media = (function (parent) {\n        var media = Object.create(parent, {\n            rating: {\n                get: function () {\n                    return this._rating;\n                },\n                set: function (rating) {\n                    validator.validateRating(rating);\n                    this._rating = rating;\n                }\n            },\n            duration: {\n                get: function () {\n                    return this._duration;\n                },\n                set: function (duration) {\n                    validator.validateDuration(duration);\n                    this._duration = duration;\n                }\n            }\n        });\n\n        media.init = function (name, rating, duration, description) {\n            parent.init.call(this, name, description);\n            this.rating = rating;\n            this.duration = duration;\n            return this;\n        };\n\n        return media;\n    }(item));\n\n    catalog = (function (parent) {\n        var catalog,\n            idGenerator = idGeneratorFactory.get();\n\n        catalog = Object.create(parent, {\n            name: {\n                get: function () {\n                    return this._name;\n                },\n                set: function (name) {\n                    validator.validateName(name);\n                    this._name = name;\n                }\n            }\n        });\n\n        catalog.init = function (name) {\n            this.id = idGenerator.getNext();\n            this.name = name;\n            this.items = [];\n            return this;\n        };\n\n        catalog._validateItem = function (item) {\n                validator.validateId(item.id);\n                validator.validateName(item.name);\n                validator.validateDescription(item.description);\n        };\n\n        catalog.add = function (item) {\n            if (typeof (item) === 'undefined') {\n                throw new Error('undefined cannot be added to a catalog');\n            }\n\n            if (typeof (item.length) !== 'undefined') {\n                return this.add.apply(this, item);\n            }\n            var itemsToAdd = [],\n                items = [].slice.call(arguments, 0),\n                that = this;\n            items.forEach(function (item) {\n                that._validateItem(item);\n                itemsToAdd.push(item);\n            });\n            [].push.apply(this.items, itemsToAdd);\n            return this;\n        };\n\n        catalog.find = function (options) {\n            if (typeof (options) === 'undefined') {\n                throw new Error('Id must be ea number');\n            }\n            var isOnlyId = false,\n                result;\n            if (typeof (options) === 'number') {\n                options = {\n                    id: options\n                };\n                isOnlyId = true;\n            }\n            result = this.items.filter(function (item) {\n                return Object.keys(options)\n                    .every(function (key) {\n                        return options[key] === item[key];\n                    });\n            });\n            if (isOnlyId) {\n                if (result.length) {\n                    return result[0];\n                }\n                return null;\n            }\n            return result;\n        };\n\n        catalog.search = function (pattern) {\n            validator.validatePattern(pattern);\n            pattern = pattern.toLowerCase();\n            return this.items.filter(function (item) {\n                return item.name.toLowerCase().indexOf(pattern) >= 0 ||\n                    item.description.toLowerCase().indexOf(pattern) >= 0;\n            });\n        };\n\n        return catalog;\n    }({}));\n\n    bookCatalog = (function (parent) {\n        var bookCatalog = Object.create(parent);\n\n        bookCatalog.init = function (name) {\n            parent.init.call(this, name);\n            return this;\n        };\n\n        bookCatalog._validateItem = function (book) {\n            parent._validateItem.call(this, book);\n            validator.validateGenre(book.genre);            \n            validator.validateISBN(book.isbn);\n        };\n\n        bookCatalog.getGenres = function () {\n            var genres = {};\n            this.items.forEach(function (item) {\n                genres[item.genre.toLowerCase()] = 1;\n            });\n            return Object.keys(genres);\n        };\n\n        return bookCatalog;\n    }(catalog));\n\n    mediaCatalog = (function (parent) {\n        var mediaCatalog = Object.create(parent);\n        mediaCatalog._isValidItem = function (media) {\n            return parent._isValidItem.call(this, media) &&\n                validator.validateDuration(media.rating) &&\n                validator.validateRating(media.duration);\n        };\n\n        mediaCatalog.getTop = function (count) {\n            validator.validateCount(count);\n            var items = this.items.slice();\n            items.sort(function (i1, i2) {\n                return i2.rating - i1.rating;\n            });\n\n            return items.slice(0, count)\n                .map(function(item){\n                    return {\n                        id: item.id,\n                        name: item.name\n                    };\n                });\n        };\n        /*\n            *   descending by duration\n            *   ascending by id\n        */\n\n        mediaCatalog.getSortedByDuration = function(){\n            var itemsToReturn = this.items.slice();\n            itemsToReturn.sort(function(i1, i2){\n                if(i1.duration === i2.duration){\n                    return i1.id - i2.id;\n                }\n                return i2.duration - i1.duration;\n            });\n        };\n\n        return mediaCatalog;\n    }(catalog));\n\n    return {\n        getBook: function (name, isbn, genre, description) {\n            return Object.create(book)\n                .init(name, isbn, genre, description);\n        },\n        getMedia: function (name, rating, duration, description) {\n            return Object.create(media)\n                .init(name, rating, duration, description);\n        },\n        getBookCatalog: function (name) {\n            return Object.create(bookCatalog)\n                .init(name);\n        },\n        getMediaCatalog: function (name) {\n            return Object.create(mediaCatalog)\n                .init(name);\n        }\n    };\n}\n\nmodule.exports = solve;"]}